(function(Q,R,S,B,T,H,s,L,M,N,x,U,O,V,A,E,W,u,X,Y,Z,$,aa,ba,ca,da,ea,fa,ga,v,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,l){H("JS");L(null,"JS.MathExt","java.lang.Float $.Number java.util.Date $.Hashtable $.Random JU.AU $.BS $.CU $.Lst $.M4 $.Measure $.P3 $.P4 $.PT $.Quat $.SB $.V3 J.api.Interface J.atomdata.RadiusData J.c.VDW J.i18n.GT JM.BondSet JS.SV $.ScriptParam $.T JU.BSUtil $.Escape $.JmolMolecule $.Logger $.Parser $.Point3fi".split(" "),function(){c$=N(function(){this.pm=
this.rand=this.e=this.vwr=null;M(this,arguments)},JS,"MathExt");O(c$,function(){});l(c$,"init",function(c){this.e=c;this.vwr=this.e.vwr;return this},"~O");l(c$,"evaluate",function(c,a,b,d){switch(d){case 135266826:case 135266818:case 135266821:case 135266318:case 135266820:case 135266822:return this.evaluateMath(c,b,d);case 1276118017:case 1276117504:case 1276117507:case 1276117508:case 1276117511:case 1276384261:case 1276383249:return this.evaluateList(c,a.intValue,b);case 1276116994:case 269484096:return this.evaluateArray(c,
b);case 135266307:case 135270418:return this.evaluateQuaternion(c,b,d);case 1276116995:return this.evaluateBin(c,b);case 135270423:return this.evaluateCache(c,b);case 1276117514:case 1276117515:return this.evaluateRowCol(c,b,d);case 1766856708:return this.evaluateColor(c,b);case 135270405:return this.evaluateCompare(c,b);case 1229980163:case 135266310:case 1276252167:return this.evaluateConnected(c,b,d);case 135402505:return this.evaluateContact(c,b);case 135270408:return this.evaluateData(c,b);case 1276118020:case 1276118018:return this.evaluateDotDist(c,
b,d,a.intValue);case 1276118019:if(269484241==a.tok)return this.evaluateDotDist(c,b,d,a.intValue);case 135266305:case 1746538509:return this.evaluateMeasure(c,b,a.tok);case 1229984263:case 135271427:return this.evaluateLoad(c,b,1229984263==d);case 1276117019:return this.evaluateFind(c,b);case 1288701959:case 1826248716:return this.evaluateFormat(c,a.intValue,b,1826248716==d);case 135368713:return this.evaluateUserFunction(c,a.value,b,a.intValue,269484241==a.tok);case 1276117018:case 1276121098:return this.evaluateGetProperty(c,
b,1276117018==d,269484241==a.tok);case 137363467:return this.evaluateHelix(c,b);case 135267841:case 135266319:case 135267842:return this.evaluatePlane(c,b,d);case 135266829:case 135287308:case 135271429:case 135270926:return this.evaluateScript(c,b,d);case 1276118022:case 1276118023:case 1276117512:return this.evaluateString(c,a.intValue,b);case 135266320:return this.evaluatePoint(c,b);case 135304707:return this.evaluatePrompt(c,b);case 135267844:return this.evaluateRandom(c,b);case 1276116993:return this.evaluateIn(c,
b);case 1276121113:return this.evaluateModulation(c,b);case 1276117020:return this.evaluateReplace(c,b);case 135267335:case 135267336:case 1238369286:return this.evaluateSubstructure(c,b,d);case 1276117011:case 1276117012:return this.evaluateSort(c,b,d);case 1297090050:return this.evaluateSymop(c,b,269484241==a.tok);case 1276117016:return this.evaluateTensor(c,b);case 135266325:return this.evaluateWithin(c,b);case 135270422:return this.evaluateWrite(c,b)}return!1},"JS.ScriptMathProcessor,JS.T,~A,~N");
l(c$,"evaluateArray",function(c,a){for(var b=Array(a.length),d=b.length;0<=--d;)b[d]=JS.SV.newT(a[d]);return c.addXAV(b)},"JS.ScriptMathProcessor,~A");l(c$,"evaluateBin",function(c,a){if(3!=a.length&&4!=a.length)return!1;var b=c.getX(),d=13==b.tok;if(!d&&7!=b.tok)return c.addX(b);var e=JS.SV.fValue(a[0]),f=JS.SV.fValue(a[1]),g=JS.SV.fValue(a[2]),h=4==a.length?JS.SV.sValue(a[3]):null,j=null;if(d)b=b.value;else{d=b.getList();b=u(d.size(),0);null!=h&&(j=JU.AU.createArrayOfHashtable(d.size()));try{for(var k=
d.size();0<=--k;)b[k]=JS.SV.fValue(null==h?d.get(k):(j[k]=d.get(k).getMap()).get(h))}catch(n){if(A(n,Exception))return!1;throw n;}}for(var f=Math.max(B(Math.floor((f-e)/g+0.01)),1),d=E(f,0),m=b.length,k=0;k<m;k++){var p=B(Math.floor((b[k]-e)/g));0>p?p=0:p>=f&&(p=f-1);d[p]++;if(null!=h){var q=j[k];if(null!=q){q.put("_bin",JS.SV.newI(p));var l=e+g*p,s=l+g;q.put("_binMin",JS.SV.newV(3,Float.$valueOf(0==p?-3.4028235E38:l)));q.put("_binMax",JS.SV.newV(3,Float.$valueOf(p==f-1?3.4028235E38:s)))}}}return c.addXAI(d)},
"JS.ScriptMathProcessor,~A");l(c$,"evaluateCache",function(c,a){return 0<a.length?!1:c.addXMap(this.vwr.fm.cacheList())},"JS.ScriptMathProcessor,~A");l(c$,"evaluateColor",function(c,a){var b=0<a.length?JS.SV.sValue(a[0]):"",d=b.startsWith("$");if(2==a.length&&b.equalsIgnoreCase("TOHSL"))return c.addXPt(JU.CU.rgbToHSL(JU.P3.newP(8==a[1].tok?JS.SV.ptValue(a[1]):JU.CU.colorPtFromString(a[1].asString())),!0));if(2==a.length&&b.equalsIgnoreCase("TORGB")){var e=JU.P3.newP(8==a[1].tok?JS.SV.ptValue(a[1]):
JU.CU.colorPtFromString(a[1].asString()));return c.addXPt(8==a[1].tok?JU.CU.hslToRGB(e):e)}if(4==a.length&&(1048589==a[3].tok||1048588==a[3].tok)){var e=JU.P3.newP(8==a[0].tok?JS.SV.ptValue(a[0]):JU.CU.colorPtFromString(a[0].asString())),f=JU.P3.newP(8==a[1].tok?JS.SV.ptValue(a[1]):JU.CU.colorPtFromString(a[1].asString())),g=1048589==a[3].tok;g&&(e=JU.CU.rgbToHSL(e,!1),f=JU.CU.rgbToHSL(f,!1));var h=new JU.SB,f=JU.V3.newVsub(f,e),j=a[2].asInt();2>j&&(j=20);f.scale(1/(j-1));for(b=0;b<j;b++)h.append(JU.Escape.escapeColor(JU.CU.colorPtToFFRGB(g?
JU.CU.hslToRGB(e):e))),e.add(f);return c.addXStr(h.toString())}j=d?null:this.vwr.cm.getColorEncoder(b);if(!d&&null==j)return c.addXStr("");e=1<a.length?JS.SV.fValue(a[1]):3.4028235E38;f=2<a.length?JS.SV.fValue(a[2]):3.4028235E38;g=3<a.length?JS.SV.fValue(a[3]):3.4028235E38;h=3.4028235E38!=g||3.4028235E38!=e&&3.4028235E38==f;3.4028235E38==f&&0==b.length&&(g=e,f=this.vwr.getCurrentColorRange(),e=f[0],f=f[1]);if(d){j=b.substring(1);j=v(-1,[j,null]);if(!this.vwr.shm.getShapePropertyData(24,"colorEncoder",
j))return c.addXStr("");j=j[1]}else j.setRange(e,f,e>f);b=j.getColorKey();return h?c.addXPt(JU.CU.colorPtFromInt(j.getArgb(3.4028235E38==f?e:g),null)):c.addX(JS.SV.getVariableMap(b))},"JS.ScriptMathProcessor,~A");l(c$,"evaluateCompare",function(c,a){if(2>a.length||5<a.length)return!1;var b,d=JS.SV.sValue(a[a.length-1]),e=d.equalsIgnoreCase("stddev"),f=d.equalsIgnoreCase("ISOMER"),g=d.equalsIgnoreCase("BONDS"),h=!f&&a.length>(e?3:2),j=10==a[0].tok?a[0].value:null,k=10==a[1].tok?a[1].value:null,n=null==
j?JS.SV.sValue(a[0]):"",m=null==k?JS.SV.sValue(a[1]):"",p=new JU.M4;b=NaN;var q,l;try{if(h&&(null==j||null==k))return!1;if(g){if(4!=a.length)return!1;n=JS.SV.sValue(a[2]);h=n.equalsIgnoreCase("SMILES");try{h&&(n=this.vwr.getSmiles(j))}catch(s){if(A(s,Exception))this.e.evalError(s.getMessage(),null);else throw s;}var r=this.e.getSmilesExt().getFlexFitList(j,k,n,!h);return null==r?c.addXStr(""):c.addXAF(r)}if(f){if(3!=a.length)return!1;if(null==j&&null==k)return c.addXStr(this.vwr.getSmilesMatcher().getRelationship(n,
m).toUpperCase());var u=null==j?this.vwr.getSmilesMatcher().getMolecularFormula(n,!1):JU.JmolMolecule.getMolecularFormula(this.vwr.ms.at,j,!1,null,!1),v=null==k?this.vwr.getSmilesMatcher().getMolecularFormula(m,!1):JU.JmolMolecule.getMolecularFormula(this.vwr.ms.at,k,!1,null,!1);if(!u.equals(v))return c.addXStr("NONE");null!=j&&(n=this.e.getSmilesExt().getSmilesMatches("",null,j,null,!1,!0,!1));var w;w=null==k?0<this.vwr.getSmilesMatcher().areEqual(m,n):0<=this.e.getSmilesExt().getSmilesMatches(n,
null,k,null,!1,!0,!1).nextSetBit(0);if(!w){q=n+m;if(0<=q.indexOf("/")||0<=q.indexOf("\\")||0<=q.indexOf("@")){if(0<=n.indexOf("@")&&(null!=k||0<=m.indexOf("@")))if(n="/invertstereo/"+n,w=null==k?0<this.vwr.getSmilesMatcher().areEqual(n,m):0<=this.e.getSmilesExt().getSmilesMatches(n,null,k,null,!1,!0,!1).nextSetBit(0))return c.addXStr("ENANTIOMERS");if(null==k)w=0<this.vwr.getSmilesMatcher().areEqual("/nostereo/"+m,n);else{var y=this.e.getSmilesExt().getSmilesMatches("/nostereo/"+n,null,k,null,!1,
!0,!1);w=0<=y.nextSetBit(0)}if(w)return c.addXStr("DIASTERIOMERS")}return c.addXStr("CONSTITUTIONAL ISOMERS")}if(null==j||null==k)return c.addXStr("IDENTICAL");b=this.e.getSmilesExt().getSmilesCorrelation(j,k,n,null,null,null,null,!1,null,null,!1,65536);return c.addXStr(0.2>b?"IDENTICAL":"IDENTICAL or CONFORMATIONAL ISOMERS (RMSD="+b+")")}if(h){q=new JU.Lst;l=new JU.Lst;var d=JS.SV.sValue(a[2]),z=d.equalsIgnoreCase("MAP"),h=d.equalsIgnoreCase("SMILES"),P=z||d.equalsIgnoreCase("SMARTS");if(h||P)d=
a.length>(e?4:3)?JS.SV.sValue(a[3]):null;var I="H".equalsIgnoreCase(d)||"allH".equalsIgnoreCase(d)||"bestH".equalsIgnoreCase(d),x="polyhedra".equalsIgnoreCase(d);x&&(d=a.length>(e?5:4)?JS.SV.sValue(a[4]):null);var C="all".equalsIgnoreCase(d)||"allH".equalsIgnoreCase(d),F="best".equalsIgnoreCase(d)||"bestH".equalsIgnoreCase(d);"stddev".equals(d)&&(d=null);n=d;if(null==d||I||C||F){if(!z&&!h||I&&x)return!1;n="/noaromatic"+(C||F?"/":" nostereo/")+this.e.getSmilesExt().getSmilesMatches(I?"H":"",null,j,
null,!1,!0,!1)}else C=!0;b=this.e.getSmilesExt().getSmilesCorrelation(j,k,n,q,l,p,null,z,null,null,F,(h?65536:131072)|(!C&&!F?4194304:0));if(z){var G=q.size();if(0==G)return c.addXStr("");var H=B(l.size()/G),y=new JU.Lst;for(b=k=0;k<H;k++){var K=JU.AU.newInt2(G);y.addLast(K);for(d=0;d<G;d++,b++)K[d]=E(-1,[q.get(d).i,l.get(b).i])}return C?c.addXList(y):0<y.size()?c.addXAII(y.get(0)):c.addXStr("")}}else{switch(a.length){case 2:break;case 3:if(e)break;default:return!1}q=this.e.getPointVector(a[0],0);
l=this.e.getPointVector(a[1],0);null!=q&&null!=l&&(J.api.Interface.getInterface("JU.Eigen",this.vwr,"script"),b=JU.Measure.getTransformMatrix4(q,l,p,null))}return e||Float.isNaN(b)?c.addXFloat(b):c.addXM4(p.round(1E-7))}catch(D){if(A(D,Exception))return this.e.evalError(null==D.getMessage()?D.toString():D.getMessage(),null),!1;throw D;}},"JS.ScriptMathProcessor,~A");l(c$,"evaluateConnected",function(c,a,b){if(5<a.length||1229980163==b&&1!=a.length)return!1;var d=-2147483648,e=2147483647,f=0,g=3.4028235E38,
h=65535,j=null,k=null,n=!1,m=!1;switch(b){case 1276252167:j=-2147483648;k=null;if(0<a.length)switch(a[0].tok){case 2:j=a[0].intValue;break;case 4:k=JS.SV.sValue(a[0])}j=v(-1,[Integer.$valueOf(j),k,null]);this.vwr.shm.getShapePropertyData(21,"centers",j);return c.addXBs(null==j[2]?new JU.BS:j[2]);case 1229980163:j=c.getX();if(10!=j.tok)return!1;j=JS.SV.bsSelectVar(j);k=JS.SV.bsSelectVar(a[0]);a=new JU.Lst;f=this.vwr.ms.at;for(b=j.nextSetBit(0);0<=b;b=j.nextSetBit(b+1)){for(var p=0,g=f[b].bonds,m=g.length;0<=
--m;)k.get(g[m].getOtherAtom(f[b]).i)&&p++;a.addLast(Integer.$valueOf(p))}return c.addXList(a)}for(b=0;b<a.length;b++){var q=a[b];switch(q.tok){case 10:if((m=s(q.value,JM.BondSet))&&null!=j)return!1;if(null==j)j=JS.SV.bsSelectVar(q);else if(null==k)k=JS.SV.bsSelectVar(q);else return!1;break;case 4:p=JS.SV.sValue(q);h=p.equalsIgnoreCase("hbond")?30720:JS.ScriptParam.getBondOrderFromString(p);if(131071==h)return!1;break;case 3:n=!0;default:p=q.asInt();q=q.asFloat();if(2147483647!=e)return!1;-2147483648==
d?(d=Math.max(p,0),f=q):(e=p,g=q)}}-2147483648==d?(d=1,e=100,f=0.1,g=1E8):2147483647==e&&(e=d,g=f,f=0.1);null==j&&(j=this.vwr.getAllAtoms());n&&null==k&&(k=j);return null!=k?(a=new JU.BS,this.vwr.makeConnections(f,g,h,1087373321,j,k,a,m,!1,0),c.addX(JS.SV.newV(10,JM.BondSet.newBS(a,this.vwr.ms.getAtomIndices(this.vwr.ms.getAtoms(1678770178,a)))))):c.addXBs(this.vwr.ms.getAtomsConnected(d,e,h,j))},"JS.ScriptMathProcessor,~A,~N");l(c$,"evaluateContact",function(c,a){if(1>a.length||3<a.length)return!1;
var b=0,d=100;switch(a[0].tok){case 3:case 2:d=JS.SV.fValue(a[b++]);break;case 10:break;default:return!1}if(b==a.length||!s(a[b].value,JU.BS))return!1;var e=JU.BSUtil.copy(JS.SV.bsSelectVar(a[b++])),b=b<a.length?JU.BSUtil.copy(JS.SV.bsSelectVar(a[b])):null,d=new J.atomdata.RadiusData(null,10<d?d/100:d,10<d?J.atomdata.RadiusData.EnumType.FACTOR:J.atomdata.RadiusData.EnumType.OFFSET,J.c.VDW.AUTO),b=this.setContactBitSets(e,b,!0,NaN,d,!1);b.or(e);return c.addXBs(b)},"JS.ScriptMathProcessor,~A");l(c$,
"evaluateData",function(c,a){var b=JS.SV.sValue(a[0]);switch(a.length){case 1:break;case 2:case 3:if(10==a[0].tok)return c.addXStr(this.vwr.getModelFileData(b,JS.SV.sValue(a[1]),3==a.length&&JS.SV.bValue(a[2])));break;case 4:var b=a[1].asInt(),d=a[2].asInt(),e=a[3].asInt(),b=JU.Parser.parseFloatArrayFromMatchAndField(JS.SV.sValue(a[0]),null,0,0,null,b,d,null,e);return c.addXStr(JU.Escape.escapeFloatA(b,!1));default:return!1}if(0==b.indexOf("data2d_"))return b=this.vwr.getDataObj(b,null,2),null==b?
c.addXStr(""):2==a.length&&2==a[1].tok?(d=a[1].intValue,0>d&&(d+=b.length),0<=d&&d<b.length?c.addXStr(JU.Escape.escapeFloatA(b[d],!1)):c.addXStr("")):c.addXStr(JU.Escape.escapeFloatAA(b,!1));if(0==b.indexOf("property_"))return b=this.vwr.getDataObj(b,null,1),null==b?c.addXStr(""):c.addXStr(JU.Escape.escapeFloatA(b,!1));b=this.vwr.getDataObj(b,null,-1);return c.addXStr(null==b?"":""+b[1])},"JS.ScriptMathProcessor,~A");l(c$,"evaluateDotDist",function(c,a,b,d){var e=1276118019==b,f,g,h=null;switch(a.length){case 2:if(2147483647==
d){f=a[0];g=a[1];break}h=a[1];case 1:f=c.getX();g=a[0];break;default:return!1}if(1276118018==b)return f=JU.P3.newP(c.ptValue(f)),f.cross(f,c.ptValue(g)),c.addXPt(f);b=7==g.tok?null:c.ptValue(g);a=c.planeValue(g);if(e){var j=-2147483648==d?0:d&480,k=32==j||64==j,n=480==j;switch(f.tok){case 10:var m=JS.SV.bsSelectVar(f),p=null,q=k&&null!=h&&h.asBoolean();switch(g.tok){case 10:p=10==g.tok?JS.SV.bsSelectVar(g):null;case 8:e=this.vwr.ms.at;if(q){g=NaN;k=2147483647;for(h=m.nextSetBit(0);0<=h;h=m.nextSetBit(h+
1))if(n=null==p?e[h].distanceSquared(b):this.e.getBitsetProperty(p,d,e[h],a,f.value,null,!1,f.index,!1).floatValue(),!(32==j?n>=g:n<=g))g=n,k=h;return c.addXBs(2147483647==k?new JU.BS:JU.BSUtil.newAndSetBit(k))}if(n){if(null==p){g=u(m.cardinality(),0);j=0;for(h=m.nextSetBit(0);0<=h;h=m.nextSetBit(h+1),j++)g[j]=e[h].distance(b);return c.addXAF(g)}f=u(m.cardinality(),p.cardinality(),0);j=0;for(h=m.nextSetBit(0);0<=h;h=m.nextSetBit(h+1),j++){b=0;for(a=p.nextSetBit(0);0<=a;a=p.nextSetBit(a+1),b++)f[j][b]=
e[h].distance(e[a])}return c.addXAFF(f)}if(k){g=u(m.cardinality(),0);h=m.nextSetBit(0);for(j=0;0<=h;h=m.nextSetBit(h+1))g[j++]=this.e.getBitsetProperty(p,d,e[h],a,f.value,null,!1,f.index,!1).floatValue();return c.addXAF(g)}return c.addXObj(this.e.getBitsetProperty(m,d,b,a,f.value,null,!1,f.index,!1))}}}m=c.ptValue(f);f=c.planeValue(f);p=NaN;try{e?p=null!=a&&null!=h?JU.Measure.directedDistanceToPlane(m,a,JS.SV.ptValue(h)):null==f?null==a?b.distance(m):JU.Measure.distanceToPlane(a,m):JU.Measure.distanceToPlane(f,
b):null!=f&&null!=a?p=f.x*a.x+f.y*a.y+f.z*a.z+f.w*a.w:(null!=f?m=JU.P3.new3(f.x,f.y,f.z):null!=a&&(b=JU.P3.new3(a.x,a.y,a.z)),p=m.dot(b))}catch(l){if(!A(l,Exception))throw l;}return c.addXFloat(p)},"JS.ScriptMathProcessor,~A,~N,~N");l(c$,"evaluateHelix",function(c,a){if(1>a.length||5<a.length)return!1;var b=2<a.length?3:1,d=b>=a.length?"array":JS.SV.sValue(a[b]),b=JS.T.getTokFromName(d);if(2<a.length){var e=c.ptValue(a[0]),f=c.ptValue(a[1]);if(0==b||9!=a[2].tok||null==e||null==f)return!1;var g=JU.Quat.newP4(a[2].value),
g=JU.Measure.computeHelicalAxis(e,f,g);return null==g?!1:c.addXObj(JU.Escape.escapeHelical(d,b,e,f,g))}d=s(a[0].value,JU.BS)?a[0].value:this.vwr.ms.getAtoms(1095763988,new Integer(a[0].asInt()));switch(b){case 135266320:return c.addXObj(this.getHelixData(d,135266320));case 1073741854:return c.addXObj(this.getHelixData(d,1073741854));case 1666189314:return c.addXObj(this.getHelixData(d,1666189314));case 135266305:return c.addXFloat(this.getHelixData(d,135266305).floatValue());case 135176:case 1746538509:return c.addXObj(this.getHelixData(d,
b));case 1276116994:g=this.getHelixData(d,1073742001);if(null==g)break;return c.addXAS(g)}return!1},"JS.ScriptMathProcessor,~A");l(c$,"getHelixData",function(c,a){var b=c.nextSetBit(0);return 0>b?"null":this.vwr.ms.at[b].group.getHelixData(a,this.vwr.getQuaternionFrame(),this.vwr.getInt(553648146))},"JU.BS,~N");l(c$,"evaluateFind",function(c,a){var b=c.getX(),d=7==b.tok,e=0==a.length,f=e?"":JS.SV.sValue(a[0]),g=1<a.length&&1048589!=a[1].tok&&1048588!=a[1].tok?JS.SV.sValue(a[1]):"",h=!d&&f.equalsIgnoreCase("SEQUENCE"),
j=!d&&f.equalsIgnoreCase("SMILES"),k=!d&&f.equalsIgnoreCase("SMARTS"),n=!d&&f.equalsIgnoreCase("CHEMICAL"),m=!d&&f.equalsIgnoreCase("MF"),p=!d&&f.equalsIgnoreCase("CELLFORMULA"),l=!d&&0<a.length&&1048589==a[a.length-1].tok;try{if(n){var t=10==b.tok?this.vwr.getSmiles(JS.SV.getBitSet(b,!1)):JS.SV.sValue(b),t=0==t.length?"":this.vwr.getChemicalInfo(t,1<a.length?JS.T.getTokenFromName(g.toLowerCase()):null);t.endsWith("\n")&&(t=t.substring(0,t.length-1));t.startsWith("InChI")&&(t=JU.PT.rep(JU.PT.rep(t,
"InChI=",""),"InChIKey=",""));return c.addXStr(t)}if(j||k||10==b.tok){var n=j||k?2:1,s=n<a.length&&10==a[n].tok?a[n++].value:null,r="bonds".equalsIgnoreCase(JS.SV.sValue(a[a.length-1])),t=r||l,n=null;switch(b.tok){case 4:var u=JS.SV.sValue(b);if(null!=s)return!1;if(g.equalsIgnoreCase("mf"))n=this.vwr.getSmilesMatcher().getMolecularFormula(u,k);else{j=g;m=!0;p=!1;switch(a.length){case 4:m=JS.SV.bValue(a[3]);case 3:p=JS.SV.bValue(a[2])}try{n=this.e.getSmilesExt().getSmilesMatches(j,u,null,null,k,!p,
!m)}catch(v){if(A(v,Exception))return c.addXInt(-1);throw v;}if(!p&&(!m||!k)){var w=n.length;return c.addXInt(!m&&0<w?1:w)}}break;case 10:if(m&&0!=g.length)return c.addXBs(JU.JmolMolecule.getBitSetForMF(this.vwr.ms.at,b.value,g));if(m||p)return c.addXStr(JU.JmolMolecule.getMolecularFormula(this.vwr.ms.at,b.value,!1,m?null:this.vwr.ms.getCellWeights(b.value),l));if(h)return c.addXStr(this.vwr.getSmilesOpt(b.value,-1,-1,256|(t?259:0)));if(j||k)f=1<a.length&&10==a[1].tok?this.vwr.getSmilesOpt(a[1].value,
0,0,0):g;if(r)var y=this.vwr.getSmilesMatcher().getCorrelationMaps(f,this.vwr.ms.at,this.vwr.ms.ac,b.value,(j?65536:131072)|4194304),n=0<y.length?this.vwr.ms.getDihedralMap(y[0]):E(0,0);else n=this.e.getSmilesExt().getSmilesMatches(f,null,b.value,s,!j,!t,!1)}null==n&&this.e.invArg();return c.addXObj(n)}}catch(z){if(A(z,Exception))this.e.evalError(z.getMessage(),null);else throw z;}k=0<=g.indexOf("v");w=0<=g.indexOf("i");g=0<=g.indexOf("m");j=2==a.length;if(d||j){m=this.getPatternMatcher();h=j=null;
u=d?b.getList():null;if(0<f.length)try{j=0==f.length?null:m.compile(f,w),h=JS.SV.strListValue(b)}catch(x){if(A(x,Exception))this.e.evalError(x.toString(),null);else throw x;}w=null==h?u.size():h.length;JU.Logger.debugging&&JU.Logger.debug("finding "+f);f=new JU.BS;m=0;l=null;p=g?new JU.Lst:null;s="";for(b=0;b<w;b++){if(null==j)switch(r=u.get(b),r.tok){case 6:r=r.getMap().isEmpty()!=e;break;case 7:r=0==r.getList().size()!=e;break;case 4:r=0==r.asString().length!=e;break;default:r=!0}else s=h[b],l=
j.matcher(s),r=l.find();if(g&&r||!g&&r==!k)m++,f.set(b),g&&p.addLast(k?s.substring(0,l.start())+s.substring(l.end()):l.group())}if(!d)return g?c.addXStr(1==p.size()?p.get(0):""):k?c.addXBool(1==m):g?c.addXStr(0==m?"":l.group()):c.addXInt(0==m?0:l.start()+1);if(g){d=Array(m);if(0<m)for(b=h.length;0<=--b;)f.get(b)&&(--m,d[m]=g?p.get(m):h[b]);return c.addXAS(d)}d=new JU.Lst;for(b=f.nextSetBit(0);0<=b;b=f.nextSetBit(b+1))d.addLast(u.get(b));return c.addXList(d)}return h?c.addXStr(this.vwr.getJBR().toStdAmino3(JS.SV.sValue(b))):
c.addXInt(JS.SV.sValue(b).indexOf(f)+1)},"JS.ScriptMathProcessor,~A");l(c$,"evaluateGetProperty",function(c,a,b,d){var e=0,f=0==a.length?0:a[0].tok;if(2==a.length&&(7==f||6==f||14==f))return c.addXObj(this.vwr.extractProperty(a[0].value,a[1].value.toString(),-1));var f=0<a.length?JS.SV.sValue(a[e++]):"",g=f.toLowerCase();0>g.indexOf("[select ")&&(f=g);var h=!1;f.equals("json")&&a.length>e&&(h=!0,f=JS.SV.sValue(a[e++]));var j=null;if(d&&(j=c.getX(),10!=j.tok))return c.addXObj(this.vwr.extractProperty(j,
f,-1));d&&(!g.startsWith("bondinfo")&&!g.startsWith("atominfo"))&&(f="atomInfo."+f);g="";if(f.equalsIgnoreCase("fileContents")&&2<a.length){e=JS.SV.sValue(a[1]);for(g=2;g<a.length;g++)e+="|"+JS.SV.sValue(a[g]);g=e;e=a.length}else if(a.length>e)switch(a[e].tok){case 10:g=JS.SV.bsSelectVar(a[e++]);f.equalsIgnoreCase("bondInfo")&&(a.length>e&&10==a[e].tok)&&(g=v(-1,[g,JS.SV.bsSelectVar(a[e])]));break;case 6:case 4:this.vwr.checkPropertyParameter(f)&&(g=a[e++].value)}if(d){j=JS.SV.bsSelectVar(j);if(0>
j.nextSetBit(0))return c.addXStr("");g=j}b&&!d&&(f="auxiliaryInfo.models."+f);f=JU.PT.rep(f,".[","[");b=this.vwr.getProperty(null,f,g);e<a.length&&(b=this.vwr.extractProperty(b,a,e));return c.addXObj(h?"{"+JU.PT.toJSON("value",b)+"}":JS.SV.isVariableType(b)?b:JU.Escape.toReadable(f,b))},"JS.ScriptMathProcessor,~A,~B,~B");l(c$,"evaluateFormat",function(c,a,b,d){var e=2>b.length||1288701959==a?c.getX():null,f=0==b.length?"%U":7==b[0].tok?null:JS.SV.sValue(b[0]);if(!d&&0<b.length&&null!=e&&null!=f){if(2==
b.length){var e=e.getList(),g=b[1].getList();if(null==e||null==g)return!1;e=JS.SV.getVariableList(this.getSublist(e,g))}b=v(-1,[b[0],e]);e=null}if(null==e){a=d?-1:JS.SV.getFormatType(f);if(0<=a&&2!=b.length)return!1;if(0<=a||2>b.length||7!=b[1].tok)return b=JS.SV.format(b,a,!1),f.equalsIgnoreCase("json")?c.addXStr(b):c.addXObj(b);f=b[1].getList();b=v(-1,[b[0],null]);d=Array(f.size());for(e=d.length;0<=--e;)b[1]=f.get(e),d[e]=JS.SV.format(b,a,!0).toString();return c.addXAS(d)}if(7==e.tok&&null==f)return e=
e.getList(),g=b[0].getList(),f=this.getSublist(e,g),c.addXList(f);b=JS.SV.getBitSet(e,!0);a=JS.T.tokAttr(a,480);return c.addXObj(null==f?"":null==b?JS.SV.sprintf(JU.PT.formatCheck(f),e):this.e.getCmdExt().getBitsetIdent(b,f,e.value,!0,e.index,a))},"JS.ScriptMathProcessor,~N,~A,~B");l(c$,"getSublist",function(c,a){for(var b=new JU.Lst,d,e,f,g=0,h=c.size();g<h;g++)switch(e=c.get(g),e.tok){case 6:d=e.getMap();f=new JU.Lst;for(var j=0,k=a.size();j<k;j++)e=d.get(JS.SV.sValue(a.get(j))),f.addLast(null==
e?JS.SV.newS(""):e);b.addLast(JS.SV.getVariableList(f));break;case 7:d=new java.util.Hashtable;f=e.getList();j=0;for(k=Math.min(f.size(),a.size());j<k;j++)d.put(JS.SV.sValue(a.get(j)),f.get(j));b.addLast(JS.SV.getVariable(d))}return b},"JU.Lst,JU.Lst");l(c$,"evaluateList",function(c,a,b){var d=b.length,e=c.getX(),f=7==e.tok,g;switch(a){case 1276384261:return 2==d&&c.addX(e.pushPop(b[1],b[0]))||1==d&&c.addX(e.pushPop(b[0],null));case 1276383249:return 1==d&&c.addX(e.pushPop(null,b[0]))||0==d&&c.addX(e.pushPop(null,
null));case 1276118017:if(1!=d&&2!=d)return!1;break;case 1276118023:case 1276118022:break;default:if(1!=d)return!1}var h=null,j=null,k=null;if(2==d){var n=JS.SV.sValue(b[0]);g=b[1];if(1276118017==a){h=f?JS.SV.strListValue(e):JU.PT.split(JS.SV.sValue(e),"\n");j=7==g.tok?JS.SV.strListValue(g):JU.PT.split(JS.SV.sValue(g),"\n");k=Array(d=Math.max(h.length,j.length));for(e=0;e<d;e++)k[e]=(e>=h.length?"":h[e])+n+(e>=j.length?"":j[e]);return c.addXAS(k)}if(1048589!=g.tok)return!1;k=e.getList();(d=0==n.length)&&
(n=",");if(1276118022==a){j=Array(k.size());for(e=k.size();0<=--e;)if(b=k.get(e).getList(),null==b)j[e]=k.get(e);else{a=new JU.SB;f=0;for(h=b.size();f<h;f++)0<f&&a.append(n),g=b.get(f),a.append(d&&4==g.tok?'"'+JU.PT.rep(g.value,'"','""')+'"':""+g.asString());j[e]=JS.SV.newS(a.toString())}return c.addXAV(j)}a=new JU.Lst;d&&(n="\x00");j=E(2,0);e=0;for(g=k.size();e<g;e++){f=k.get(e).asString();if(d){j[1]=0;for(h=j[0]=0;;){b=JU.PT.getCSVString(f,j);if(null==b){if(-1==j[1]){f+=++e<g?"\n"+k.get(e).asString():
'"';j[1]=h;continue}f=f.substring(0,h)+f.substring(h).$replace(",","\x00");break}f=f.substring(0,h)+f.substring(h,j[0]).$replace(",","\x00")+b+f.substring(j[1]);j[1]=h=j[0]+b.length}}for(var m=f.$plit(n),l=new JU.Lst,f=0,h=m.length;f<h;f++){b=m[f];if(0>b.indexOf("."))try{l.addLast(JS.SV.newI(Integer.parseInt(b)));continue}catch(q){if(!A(q,Exception))throw q;}else try{l.addLast(JS.SV.getVariable(Float.$valueOf(Float.parseFloat(b))));continue}catch(s){if(!A(s,Exception))throw s;}l.addLast(JS.SV.newS(b))}a.addLast(JS.SV.getVariableList(l))}return c.addXObj(JS.SV.getVariableList(a))}g=
0==d?JS.SV.newV(1048579,"all"):b[0];k=1048579==g.tok;if(!f&&4!=e.tok)return c.binaryOp(this.opTokenFor(a),e,g);var m=JS.SV.isScalar(e),v=JS.SV.isScalar(g),r=l=null,n=e.getList(),x=g.getList();f?d=n.size():m?d=2147483647:(h=JU.PT.split(JS.SV.sValue(e),"\n"),l=u(d=h.length,0),JU.PT.parseFloatArrayData(h,l));if(k&&1276118022!=a){k=0;if(f)for(e=d;0<=--e;)k+=JS.SV.fValue(n.get(e));else if(!m)for(e=d;0<=--e;)k+=l[e];return c.addXFloat(k)}if(1276118022==a&&4==g.tok){a=new JU.SB;if(m)a.append(JS.SV.sValue(e));
else{b=k?"":g.value.toString();for(e=0;e<d;e++)a.append(0<e?b:"").append(JS.SV.sValue(n.get(e)))}return c.addXStr(a.toString())}var B=null;v?B=g:7==g.tok?d=Math.min(d,x.size()):(j=JU.PT.split(JS.SV.sValue(g),"\n"),r=u(j.length,0),JU.PT.parseFloatArrayData(j,r),d=Math.min(d,r.length));var w=this.opTokenFor(a),y=Array(d);if(f&&k)return k=new JU.Lst,c.addXList(this.addAllLists(e.getList(),k));b=m?e:null;for(var z,e=0;e<d;e++){z=v?B:7==g.tok?x.get(e):Float.isNaN(r[e])?JS.SV.getVariable(JS.SV.unescapePointOrBitsetAsVariable(j[e])):
JS.SV.newV(3,Float.$valueOf(r[e]));m||(b=f?n.get(e):Float.isNaN(l[e])?JS.SV.getVariable(JS.SV.unescapePointOrBitsetAsVariable(h[e])):JS.SV.newV(3,Float.$valueOf(l[e])));1276118022==a&&7!=b.tok&&(k=new JU.Lst,k.addLast(b),b=JS.SV.getVariableList(k));if(!c.binaryOp(w,b,z))return!1;y[e]=c.getX()}return c.addXAV(y)},"JS.ScriptMathProcessor,~N,~A");l(c$,"addAllLists",function(c,a){for(var b=c.size(),d=0;d<b;d++){var e=c.get(d);7==e.tok?this.addAllLists(e.getList(),a):a.addLast(e)}return a},"JU.Lst,JU.Lst");
l(c$,"evaluateLoad",function(c,a,b){var d=-1,e=!1,f=this.vwr.async;switch(a.length){case 3:f=JS.SV.bValue(a[2]);case 2:d=2==a[1].tok?a[1].asInt():-1,e=1048589==a[1].tok;case 1:a=JS.SV.sValue(a[0]);a=a.$replace("\\","/");break;default:return!1}if(e)return c.addXMap(this.vwr.fm.getFileAsMap(a));e=a.startsWith("?");if(this.vwr.isJS&&(e||f)){if(b&&e)return c.addXStr("");a=this.e.loadFileAsync("load()_",a,c.oPt,!0)}return c.addXStr(b?this.vwr.fm.getFilePath(a,!1,!1):this.vwr.getFileAsString4(a,d,!1,!1,
!0,"script"))},"JS.ScriptMathProcessor,~A,~B");l(c$,"evaluateMath",function(c,a,b){if(135266318==b)return 1==a.length&&4==a[0].tok?c.addXStr(new java.util.Date+"\t"+JS.SV.sValue(a[0])):c.addXInt((System.currentTimeMillis()&2147483647)-(0==a.length?0:a[0].asInt()));if(1!=a.length)return!1;if(135266826==b)return 2==a[0].tok?c.addXInt(Math.abs(a[0].asInt())):c.addXFloat(Math.abs(a[0].asFloat()));a=JS.SV.fValue(a[0]);switch(b){case 135266818:return c.addXFloat(180*Math.acos(a)/3.141592653589793);case 135266821:return c.addXFloat(Math.cos(3.141592653589793*
a/180));case 135266820:return c.addXFloat(Math.sin(3.141592653589793*a/180));case 135266822:return c.addXFloat(Math.sqrt(a))}return!1},"JS.ScriptMathProcessor,~A,~N");l(c$,"evaluateMeasure",function(c,a,b){var d=0;switch(b){case 1746538509:b=new JU.Lst;for(var e=u(-1,[3.4028235E38,3.4028235E38]),f=null,g=null,h=!1,j=!1,k=0,l=!1,m=null,p=0,q=3.4028235E38,s=!1,v=!1,m=0;m<a.length;m++)switch(a[m].tok){case 10:var r=a[m].value;0==r.length()&&(l=!0);b.addLast(r);d++;p++;break;case 8:r=new JU.Point3fi;
r.setT(a[m].value);b.addLast(r);d++;break;case 2:case 3:e[k++%2]=JS.SV.fValue(a[m]);break;case 4:r=JS.SV.sValue(a[m]);r.equalsIgnoreCase("vdw")||r.equalsIgnoreCase("vanderwaals")?q=(m+1<a.length&&2==a[m+1].tok?a[++m].asInt():100)/100:r.equalsIgnoreCase("notConnected")?j=!0:r.equalsIgnoreCase("connected")?h=!0:r.equalsIgnoreCase("minArray")?s=1<=p:r.equalsIgnoreCase("asArray")?v=1<=p:JU.PT.isOneOf(r.toLowerCase(),";nm;nanometers;pm;picometers;angstroms;ang;au;")||r.endsWith("hz")?g=r.toLowerCase():
f=d+":"+r;break;default:return!1}if(2>d||4<d||2<k||j&&h)return!1;if(l||3.4028235E38!=q&&(2!=p||2!=d))return c.addXStr("");m=3.4028235E38==q?new J.atomdata.RadiusData(e,0,null,null):new J.atomdata.RadiusData(null,q,J.atomdata.RadiusData.EnumType.FACTOR,J.c.VDW.AUTO);return c.addXObj(this.vwr.newMeasurementData(null,b).set(0,null,m,f,g,null,h,j,null,!0,0,0,null).getMeasurements(v,s));case 135266305:if(3!=(d=a.length)&&4!=d)return!1;break;default:if(2!=(d=a.length))return!1}b=Array(d);for(m=0;m<d;m++)if(null==
(b[m]=c.ptValue(a[m])))return!1;switch(d){case 2:return c.addXFloat(b[0].distance(b[1]));case 3:return c.addXFloat(JU.Measure.computeAngleABC(b[0],b[1],b[2],!0));case 4:return c.addXFloat(JU.Measure.computeTorsion(b[0],b[1],b[2],b[3],!0))}return!1},"JS.ScriptMathProcessor,~A,~N");l(c$,"evaluateModulation",function(c,a){var b="",d=NaN,e=null;switch(a.length){case 0:break;case 1:switch(a[0].tok){case 8:e=a[0].value;break;case 4:b=a[0].asString();break;default:d=JS.SV.fValue(a[0])}break;case 2:b=JS.SV.sValue(a[0]);
d=JS.SV.fValue(a[1]);break;default:return!1}null==e&&1E6>d&&(e=JU.P3.new3(d,d,d));d=JS.SV.getBitSet(c.getX(),!1);return c.addXList(this.vwr.ms.getModulationList(d,(b+"D").toUpperCase().charAt(0),e))},"JS.ScriptMathProcessor,~A");l(c$,"evaluatePlane",function(c,a,b){if(135267841==b&&3!=a.length||135267842==b&&2!=a.length&&3!=a.length||0==a.length||4<a.length)return!1;var d,e,f,g,h;switch(a.length){case 1:if(10==a[0].tok&&(b=JS.SV.getBitSet(a[0],!1),3==b.cardinality()))return a=this.vwr.ms.getAtomPointVector(b),
c.addXPt4(JU.Measure.getPlaneThroughPoints(a.get(0),a.get(1),a.get(2),new JU.V3,new JU.V3,new JU.P4));a=JU.Escape.uP(JS.SV.sValue(a[0]));return s(a,JU.P4)?c.addXPt4(a):c.addXStr(""+a);case 2:if(135267842==b){if(9!=a[1].tok)return!1;f=new JU.P3;b=new JU.V3;h=new JU.V3;g=a[1].value;if(9==a[0].tok)return a=JU.Measure.getIntersectionPP(a[0].value,g),null==a?c.addXStr(""):c.addXList(a);e=c.ptValue(a[0]);return null==e?c.addXStr(""):c.addXPt(JU.Measure.getIntersection(e,null,g,f,b,h))}case 3:case 4:switch(b){case 135267841:return c.addXPt4(this.e.getHklPlane(JU.P3.new3(JS.SV.fValue(a[0]),
JS.SV.fValue(a[1]),JS.SV.fValue(a[2]))));case 135267842:d=c.ptValue(a[0]);e=c.ptValue(a[1]);if(null==d||null==e)return c.addXStr("");e=JU.V3.newV(e);e.normalize();if(9==a[2].tok)return f=new JU.P3,b=new JU.V3,h=new JU.V3,d=JU.Measure.getIntersection(d,e,a[2].value,f,b,h),null==d?c.addXStr(""):c.addXPt(d);f=c.ptValue(a[2]);if(null==f)return c.addXStr("");a=new JU.V3;JU.Measure.projectOntoAxis(f,d,e,a);return c.addXPt(f)}switch(a[0].tok){case 2:case 3:if(3==a.length)return d=JS.SV.fValue(a[0]),f=JS.SV.fValue(a[1]),
a=JS.SV.fValue(a[2]),b=JU.V3.new3(0,0,1),e=JU.P3.new3(0,1,0),a=JU.Quat.newVA(e,a),a.getMatrix().rotate(b),e.set(0,0,1),a=JU.Quat.newVA(e,f),a.getMatrix().rotate(b),e.setT(b),e.scale(d),g=new JU.P4,JU.Measure.getPlaneThroughPoint(e,b,g),c.addXPt4(g);break;case 10:case 8:d=c.ptValue(a[0]);e=c.ptValue(a[1]);if(null==e)return!1;f=2<a.length&&(10==a[2].tok||8==a[2].tok)?c.ptValue(a[2]):null;b=JU.V3.newV(e);if(null==f)return g=new JU.P4,2==a.length||!a[2].asBoolean()?(f=JU.P3.newP(d),f.add(e),f.scale(0.5),
b.sub(d),b.normalize()):1048589==a[2].tok?f=d:(b.sub(d),f=new JU.P3,f.scaleAdd2(a[2].asFloat(),b,d)),JU.Measure.getPlaneThroughPoint(f,b,g),c.addXPt4(g);h=new JU.V3;a=4==a.length?c.ptValue(a[3]):null;a=JU.Measure.getDirectedNormalThroughPoints(d,e,f,a,b,h);return c.addXPt4(JU.P4.new4(b.x,b.y,b.z,a))}}if(4!=a.length)return!1;b=JS.SV.fValue(a[0]);e=JS.SV.fValue(a[1]);d=JS.SV.fValue(a[2]);a=JS.SV.fValue(a[3]);return c.addXPt4(JU.P4.new4(b,e,d,a))},"JS.ScriptMathProcessor,~A,~N");l(c$,"evaluatePoint",
function(c,a){switch(a.length){default:return!1;case 1:if(3==a[0].tok||2==a[0].tok)return c.addXInt(a[0].asInt());var b=JS.SV.sValue(a[0]);7==a[0].tok&&(b="{"+b+"}");b=JU.Escape.uP(b);return s(b,JU.P3)?c.addXPt(b):c.addXStr(""+b);case 2:b=JS.SV.ptValue(a[0]);if(null==b)return!1;1048588==a[1].tok?this.vwr.tm.unTransformPoint(b,b):this.vwr.tm.transformPt3f(b,b);return c.addXPt(b);case 3:return c.addXPt(JU.P3.new3(a[0].asFloat(),a[1].asFloat(),a[2].asFloat()));case 4:return c.addXPt4(JU.P4.new4(a[0].asFloat(),
a[1].asFloat(),a[2].asFloat(),a[3].asFloat()))}},"JS.ScriptMathProcessor,~A");l(c$,"evaluatePrompt",function(c,a){if(1!=a.length&&2!=a.length&&3!=a.length)return!1;var b=JS.SV.sValue(a[0]),d=1<a.length&&7==a[1].tok?JS.SV.strListValue(a[1]):null,e=null!=d||1==a.length||3==a.length&&a[2].asBoolean(),f=null!=d?null:2<=a.length?JS.SV.sValue(a[1]):"OK",b=""+this.vwr.prompt(b,f,d,e);return e&&null!=d?c.addXInt(Integer.parseInt(b)+1):c.addXStr(b)},"JS.ScriptMathProcessor,~A");l(c$,"evaluateQuaternion",function(c,
a,b){var d=null,e=a.length,f=2147483647,g=!1;135270418==b&&(1<e&&(4==a[e-1].tok&&a[e-1].value.equalsIgnoreCase("relative"))&&(e--,g=!0),1<e&&(2==a[e-1].tok&&10==a[0].tok)&&(f=a[e-1].asInt(),0>=f&&(f=2147483646),e--));switch(e){case 0:case 1:case 4:break;case 2:if(135270418==b){if(7==a[0].tok&&(7==a[1].tok||1048589==a[1].tok))break;if(10==a[0].tok&&(2==a[1].tok||10==a[1].tok))break}if(null==(d=c.ptValue(a[0]))||135270418!=b&&8==a[1].tok)return!1;break;case 3:if(135270418!=b)return!1;if(9==a[0].tok){if(8!=
a[2].tok&&10!=a[2].tok)return!1;break}for(var h=0;3>h;h++)if(8!=a[h].tok&&10!=a[h].tok)return!1;break;default:return!1}var j=h=null,k=null;switch(e){case 0:return c.addXPt4(this.vwr.tm.getRotationQ().toPoint4f());default:if(135270418==b&&7==a[0].tok){b=this.e.getQuaternionArray(a[0].getList(),1073742001);a=JU.Quat.sphereMean(b,null,1E-4);h=s(a,JU.Quat)?a:null;break}else if(135270418==b&&10==a[0].tok)j=this.vwr.getAtomGroupQuaternions(a[0].value,f);else if(11==a[0].tok)h=JU.Quat.newM(a[0].value);else if(9==
a[0].tok)k=a[0].value;else if(k=JS.SV.sValue(a[0]),k=JU.Escape.uP(k.equalsIgnoreCase("best")?this.vwr.getOrientationText(1073741863,null):k),!s(k,JU.P4))return!1;135266307==b&&(h=JU.Quat.newVA(JU.P3.new3(k.x,k.y,k.z),k.w));break;case 2:if(135270418==b){if(7==a[0].tok&&7==a[1].tok){b=this.e.getQuaternionArray(a[0].getList(),1073742001);j=this.e.getQuaternionArray(a[1].getList(),1073742001);j=JU.Quat.div(j,b,f,g);break}if(7==a[0].tok&&1048589==a[1].tok)return b=this.e.getQuaternionArray(a[0].getList(),
1073742001),f=u(1,0),JU.Quat.sphereMean(b,f,1E-4),c.addXFloat(f[0]);if(10==a[0].tok&&10==a[1].tok){b=this.vwr.getAtomGroupQuaternions(a[0].value,2147483647);j=this.vwr.getAtomGroupQuaternions(a[1].value,2147483647);j=JU.Quat.div(j,b,f,g);break}}h=c.ptValue(a[1]);k=c.planeValue(a[0]);h=null!=h?JU.Quat.getQuaternionFrame(JU.P3.new3(0,0,0),d,h):JU.Quat.newVA(d,JS.SV.fValue(a[1]));break;case 3:if(9==a[0].tok)return f=8==a[2].tok?a[2].value:this.vwr.ms.getAtomSetCenter(a[2].value),c.addXStr(JU.Escape.drawQuat(JU.Quat.newP4(a[0].value),
"q",JS.SV.sValue(a[1]),f,1));b=Array(3);for(h=0;3>h;h++)b[h]=8==a[h].tok?a[h].value:this.vwr.ms.getAtomSetCenter(a[h].value);h=JU.Quat.getQuaternionFrame(b[0],b[1],b[2]);break;case 4:135270418==b?k=JU.P4.new4(JS.SV.fValue(a[1]),JS.SV.fValue(a[2]),JS.SV.fValue(a[3]),JS.SV.fValue(a[0])):h=JU.Quat.newVA(JU.P3.new3(JS.SV.fValue(a[0]),JS.SV.fValue(a[1]),JS.SV.fValue(a[2])),JS.SV.fValue(a[3]))}if(null!=j){if(2147483647!=f){f=new JU.Lst;for(h=0;h<j.length;h++)f.addLast(j[h].toPoint4f());return c.addXList(f)}h=
0<j.length?j[0]:null}return c.addXPt4((null==h?JU.Quat.newP4(k):h).toPoint4f())},"JS.ScriptMathProcessor,~A,~N");l(c$,"evaluateRandom",function(c,a){if(3<a.length)return!1;null==this.rand&&(this.rand=new java.util.Random);var b=0,d=1;switch(a.length){case 3:this.rand.setSeed(x(JS.SV.fValue(a[2])));case 2:d=JS.SV.fValue(a[1]);case 1:b=JS.SV.fValue(a[0]);case 0:break;default:return!1}return c.addXFloat(this.rand.nextFloat()*(d-b)+b)},"JS.ScriptMathProcessor,~A");l(c$,"evaluateRowCol",function(c,a,b){if(1!=
a.length)return!1;a=a[0].asInt()-1;var d=c.getX();switch(d.tok){case 11:if(0>a||2<a)break;d=d.value;switch(b){case 1276117515:return b=u(3,0),d.getRow(a,b),c.addXAF(b);default:return b=u(3,0),d.getColumn(a,b),c.addXAF(b)}case 12:if(0>a||2<a)break;d=d.value;switch(b){case 1276117515:return b=u(4,0),d.getRow(a,b),c.addXAF(b);default:return b=u(4,0),d.getColumn(a,b),c.addXAF(b)}case 7:b=d.getList();for(var d=new JU.Lst,e=0,f=b.size();e<f;e++){var g=b.get(e).getList();if(null==g)return c.addXStr("");
d.addLast(a<g.size()?g.get(a):JS.SV.newS(""))}return c.addXList(d)}return!1},"JS.ScriptMathProcessor,~A,~N");l(c$,"evaluateIn",function(c,a){var b=c.getX();switch(a.length){case 1:var d=a[0].getList();if(null!=d)for(var e=0,f=d.size();e<f;e++)if(JS.SV.areEqual(b,d.get(e)))return c.addXInt(e+1);break;default:for(e=0;e<a.length;e++)if(JS.SV.areEqual(b,a[e]))return c.addXInt(e+1)}return c.addXInt(0)},"JS.ScriptMathProcessor,~A");l(c$,"evaluateReplace",function(c,a){var b=!1,d,e;switch(a.length){case 0:b=
!0;d=e=null;break;case 3:b=JS.SV.bValue(a[2]);case 2:d=JS.SV.sValue(a[0]);e=JS.SV.sValue(a[1]);break;default:return!1}var f=c.getX();if(7==f.tok){for(var f=JS.SV.strListValue(f),g=Array(f.length),h=f.length;0<=--h;)g[h]=null==d?JU.PT.clean(f[h]):b?JU.PT.replaceAllCharacters(f[h],d,e):JU.PT.rep(f[h],d,e);return c.addXAS(g)}f=JS.SV.sValue(f);return c.addXStr(null==d?JU.PT.clean(f):b?JU.PT.replaceAllCharacters(f,d,e):JU.PT.rep(f,d,e))},"JS.ScriptMathProcessor,~A");l(c$,"evaluateScript",function(c,a,
b){if((135266829==b||135270926==b||135287308==b)&&1!=a.length||0==a.length||2<a.length)return!1;var d=JS.SV.sValue(a[0]),e=new JU.SB;switch(b){case 135266829:return c.addXObj(this.vwr.evaluateExpressionAsVariable(d));case 135271429:a=2==a.length?JS.SV.sValue(a[1]):".";a.equals(".")||e.append(this.vwr.jsEval(a+"\u0001"+d));(a.equals(".")||a.equals("*"))&&this.e.runScriptBuffer(d,e);break;case 135270926:this.e.runScriptBuffer("show "+d,e);break;case 135287308:e.append(this.vwr.jsEval(d))}var d=e.toString(),
f;return Float.isNaN(f=JU.PT.parseFloatStrict(d))?c.addXStr(d):0<=d.indexOf(".")?c.addXFloat(f):c.addXInt(JU.PT.parseInt(d))},"JS.ScriptMathProcessor,~A,~N");l(c$,"evaluateSort",function(c,a,b){if(1<a.length)return!1;if(1276117011==b){var d=0==a.length?0:a[0].asInt();return c.addX(c.getX().sortOrReverse(d))}b=c.getX();a=0==a.length?null:a[0];if(4==b.tok){var d=0,e=JS.SV.sValue(b);if(null==a)return c.addXInt(0);a=JS.SV.sValue(a);for(b=0;b<e.length;b++){b=e.indexOf(a,b);if(0>b)break;d++}return c.addXInt(d)}var d=
new JU.Lst,f=e=null,g=JS.SV.getVariable(b.value).sortOrReverse(0).getList();if(null==g)return null==a?c.addXStr(""):c.addXInt(0);b=0;for(var h=g.size();b<=h;b++){var j=b==h?null:g.get(b);if(!(null!=a&&null!=j&&!JS.SV.areEqual(j,a)))if(JS.SV.areEqual(j,e))f.intValue++;else{if(null!=e){var k=new JU.Lst;k.addLast(e);k.addLast(f);d.addLast(JS.SV.getVariableList(k))}f=JS.SV.newI(1);e=j}}return null==a?c.addX(JS.SV.getVariableList(d)):d.isEmpty()?c.addXInt(0):c.addX(d.get(0).getList().get(1))},"JS.ScriptMathProcessor,~A,~N");
l(c$,"evaluateString",function(c,a,b){var d=c.getX(),e=0<b.length?JS.SV.sValue(b[0]):1276117512==a?"":"\n";switch(b.length){case 0:case 1:break;case 2:if(7==d.tok)break;if(1276118023==a){d=JS.SV.getVariable(JU.PT.split(JU.PT.rep(d.value,"\n\r","\n").$replace("\r","\n"),"\n"));break}default:return!1}if(7==d.tok&&1276117512!=a&&(1276118023!=a||2==b.length))return c.addX(d),this.evaluateList(c,a,b);b=1276118023==a&&10==d.tok||1276117512==a&&7==d.tok?null:JS.SV.sValue(d);switch(a){case 1276118023:if(10==
d.tok){var d=JS.SV.bsSelectVar(d),e="\n",f=this.vwr.ms.mc;b="";for(a=0;a<f;a++){b+=0==a?"":"\n";var g=this.vwr.getModelUndeletedAtomsBitSet(a);g.and(d);b+=JU.Escape.eBS(g)}}return c.addXAS(JU.PT.split(b,e));case 1276118022:return 0<b.length&&"\n"==b.charAt(b.length-1)&&(b=b.substring(0,b.length-1)),c.addXStr(JU.PT.rep(b,"\n",e));case 1276117512:if(null!=b)return c.addXStr(JU.PT.trim(b,e));b=JS.SV.strListValue(d);for(a=b.length;0<=--a;)b[a]=JU.PT.trim(b[a],e);return c.addXAS(b)}return c.addXStr("")},
"JS.ScriptMathProcessor,~N,~A");l(c$,"evaluateSubstructure",function(c,a,b){if(0==a.length)return!1;var d=new JU.BS,e=JS.SV.sValue(a[0]);if(0<e.length)try{var f=2==a.length&&10==a[1].tok?JS.SV.bsSelectVar(a[1]):null,d=this.vwr.getSmilesMatcher().getSubstructureSet(e,this.vwr.ms.at,this.vwr.ms.ac,f,135267336==b?65536:131072)}catch(g){if(A(g,Exception))this.e.evalError(g.getMessage(),null);else throw g;}return c.addXBs(d)},"JS.ScriptMathProcessor,~A,~N");l(c$,"evaluateSymop",function(c,a,b){if(0==a.length)return!1;
b=b?c.getX():null;if(null!=b&&10!=b.tok)return!1;b=null!=b?b.value:2<a.length&&10==a[1].tok?a[1].value:this.vwr.getAllAtoms();var d;switch(a[0].tok){case 4:d=JS.SV.sValue(a[0]);break;case 12:d=a[0].escape();break;default:d=null}var e=null==d?a[0].asInt():0,f=1<a.length?c.ptValue(a[1]):null;if(2==a.length&&null!=f)return c.addXObj(this.vwr.ms.getSymTemp(!1).getSymmetryInfoAtom(this.vwr.ms,b,d,e,f,null,null,135266320));a=(1==a.length?"matrix":JS.SV.sValue(a[a.length-1])).toLowerCase();var g=135176;
a.equalsIgnoreCase("matrix")?g=12:a.equalsIgnoreCase("array")||a.equalsIgnoreCase("list")?g=1073742001:a.equalsIgnoreCase("description")?g=1826248716:a.equalsIgnoreCase("xyz")?g=1073741982:a.equalsIgnoreCase("translation")?g=1073742178:a.equalsIgnoreCase("axis")?g=1073741854:a.equalsIgnoreCase("plane")?g=135266319:a.equalsIgnoreCase("angle")?g=135266305:a.equalsIgnoreCase("axispoint")?g=135266320:a.equalsIgnoreCase("center")&&(g=12289);return c.addXObj(this.vwr.ms.getSymTemp(!1).getSymmetryInfoAtom(this.vwr.ms,
b,d,e,f,null,a,g))},"JS.ScriptMathProcessor,~A,~B");l(c$,"evaluateTensor",function(c,a){if(2<a.length)return!1;var b=JS.SV.getBitSet(c.getX(),!1),d=0==a.length?null:JS.SV.sValue(a[0]).toLowerCase(),e=this.vwr.getNMRCalculation();if("unique".equals(d))return c.addXBs(e.getUniqueTensorSet(b));var f=2>a.length?null:JS.SV.sValue(a[1]).toLowerCase();return c.addXList(e.getTensorInfo(d,f,b))},"JS.ScriptMathProcessor,~A");l(c$,"evaluateUserFunction",function(c,a,b,d,e){var f=null;if(e)switch(f=c.getX(),
f.tok){case 10:break;case 6:if(0<b.length)return!1;f=f.getMap().get(a);return null==f?c.addXStr(""):c.addX(f);default:return!1}a=a.toLowerCase();c.wasX=!1;for(var g=new JU.Lst,h=0;h<b.length;h++)g.addLast(b[h]);if(e)return c.addXObj(this.e.getBitsetProperty(JS.SV.bsSelectVar(f),d,null,null,f.value,v(-1,[a,g]),!1,f.index,!1));a=this.e.getUserFunctionResult(a,g,null);return null==a?!1:c.addX(a)},"JS.ScriptMathProcessor,~S,~A,~N,~B");l(c$,"evaluateWithin",function(c,a){if(1>a.length||5<a.length)return!1;
var b=a.length,d=0,e=a[0].value,f=""+e,g=a[0].tok;4==g&&(g=JS.T.getTokFromName(f));var h=1649412120==g;h&&(d=100,e=null);var j=this.vwr.ms,k=!1,l=!1,m=!1,p=h||3==g||2==g,q=null;switch(g){case 1048580:return 3==b&&s(a[1].value,JU.BS)&&s(a[2].value,JU.BS)&&c.addXBs(this.vwr.getBranchBitSet(a[2].value.nextSetBit(0),a[1].value.nextSetBit(0),!0));case 135267336:case 1238369286:case 135267335:d=null;f=!0;switch(b){case 2:break;case 3:if(f=10==a[2].tok)d=a[2].value;break;default:f=!1}f||this.e.invArg();
return c.addXObj(this.e.getSmilesExt().getSmilesMatches(JS.SV.sValue(a[1]),null,d,null,135267335==g,c.asBitSet,!1))}if(s(e,String)){if(0==g){g=1048614;if(2<b)return!1;b=2}}else if(p){h||(d=JS.SV.fValue(a[0]));if(2>b)return!1;switch(g=a[1].tok){case 1048589:case 1048588:k=a[1].asBoolean();b=0;2<a.length&&JS.SV.sValue(a[2]).equalsIgnoreCase("unitcell")&&(g=1614417948);break;case 4:g=JS.SV.sValue(a[1]);if(g.startsWith("$"))return c.addXBs(this.getAtomsNearSurface(d,g.substring(1)));l=g.equalsIgnoreCase("group");
h=!l&&g.equalsIgnoreCase("vanderwaals");m=!l&&g.equalsIgnoreCase("unitcell");g=h?1649412120:m?1614417948:1087373318}}else return!1;m=e=null;switch(b){case 1:switch(g){case 137363467:case 3145760:case 1679429641:return c.addXBs(j.getAtoms(g,null));case 1073741864:return c.addXBs(j.getAtoms(g,""));case 1048614:return c.addXBs(j.getAtoms(1087373320,f))}return!1;case 2:switch(g){case 1048614:g=1087373320;break;case 1087375362:case 1087375361:case 1073741864:case 1087373320:case 1073741916:case 1073742128:case 1073741925:case 1073742189:return c.addXBs(this.vwr.ms.getAtoms(g,
JS.SV.sValue(a[a.length-1])))}break;case 3:switch(g){case 1048589:case 1048588:case 1087373318:case 1649412120:case 1614417948:case 135266319:case 135267841:case 1048581:break;case 1087373320:f=JS.SV.sValue(a[2]);break;default:return!1}}b=a.length-1;s(a[b].value,JU.P4)?m=a[b].value:s(a[b].value,JU.P3)&&(e=a[b].value,JS.SV.sValue(a[1]).equalsIgnoreCase("hkl")&&(m=this.e.getHklPlane(e)));if(0<b&&null==m&&null==e&&!s(a[b].value,JU.BS))return!1;if(null!=m)return c.addXBs(j.getAtomsNearPlane(d,m));b=10==
a[b].tok?JS.SV.bsSelectVar(a[b]):null;if(1614417948==g)return c.addXObj(this.vwr.ms.getUnitCellPointsWithin(d,b,e,k));if(null!=e)return c.addXBs(this.vwr.getAtomsNearPt(d,e));if(1087373320==g)return c.addXBs(this.vwr.ms.getSequenceBits(f,b));null==b&&(b=new JU.BS);if(!p)return c.addXBs(this.vwr.ms.getAtoms(g,b));if(l)return c.addXBs(this.vwr.getGroupsWithin(x(d),b));h&&(q=new J.atomdata.RadiusData(null,10<d?d/100:d,10<d?J.atomdata.RadiusData.EnumType.FACTOR:J.atomdata.RadiusData.EnumType.OFFSET,J.c.VDW.AUTO));
return c.addXBs(this.vwr.ms.getAtomsWithinRadius(d,b,k,q))},"JS.ScriptMathProcessor,~A");l(c$,"evaluateWrite",function(c,a){switch(a.length){case 0:return!1;case 1:if(!a[0].asString().toUpperCase().equals("PNGJ"))break;return c.addXMap(this.vwr.fm.getFileAsMap(null))}return c.addXStr(this.e.getCmdExt().dispatch(135270422,!0,a))},"JS.ScriptMathProcessor,~A");l(c$,"getAtomsNearSurface",function(c,a){var b=v(-1,[a,null,null]);if(this.e.getShapePropertyData(24,"getVertices",b))return this.getAtomsNearPts(c,
b[1],b[2]);b[1]=Integer.$valueOf(0);b[2]=Integer.$valueOf(-1);return this.e.getShapePropertyData(22,"getCenter",b)?this.vwr.getAtomsNearPt(c,b[2]):new JU.BS},"~N,~S");l(c$,"getAtomsNearPts",function(c,a,b){var d=new JU.BS;if(0==a.length||null!=b&&0==b.cardinality())return d;null==b&&(b=JU.BSUtil.setAll(a.length));for(var e=this.vwr.ms.at,f=this.vwr.ms.ac;0<=--f;)for(var g=e[f],h=b.nextSetBit(0);0<=h;h=b.nextSetBit(h+1))if(g.distance(a[h])<c){d.set(f);break}return d},"~N,~A,JU.BS");l(c$,"getMinMax",
function(c,a){for(var b=null,d=null,e=0,f=null;;){if(JU.AU.isAF(c)){if(b=c,e=b.length,0==e)break}else if(s(c,JU.Lst))if(d=c,e=d.size(),0==e){if(1141899283!=a)break}else{var g=d.get(0);if(4==g.tok&&g.value.startsWith("{")){b=JS.SV.ptValue(g);if(s(b,JU.P3))return this.getMinMaxPoint(d,a);if(s(b,JU.P4))return this.getMinMaxQuaternion(d,a);break}}else break;var h,j=!1;switch(a){case 1141899283:f=new java.util.Hashtable;g=h=0;break;case 32:j=!0;g=3.4028235E38;h=2147483647;break;case 64:g=-3.4028235E38;
h=-2147483647;break;default:g=h=0}for(var k=0,l=0,m=!0,p=1141899283==a;0<=--e;){var q=d.get(e),t=p?1:null==b?JS.SV.fValue(q):b[e];if(!Float.isNaN(t))switch(l++,a){case 160:case 192:k+=t*t;case 128:case 96:g+=t;break;case 1141899283:m=(new Boolean(m&2==q.tok)).valueOf();q=q.asString();t=f.get(q);f.put(q,null==t?new Integer(1):new Integer(t.intValue()+1));break;case 32:case 64:m=(new Boolean(m&2==q.tok)).valueOf(),j==t<g&&(g=t,m&&(h=q.intValue))}}if(1141899283==a)return f;if(0==l)break;switch(a){case 96:g/=
l;break;case 192:if(1==l)break;g=Math.sqrt((k-g*g/l)/(l-1));break;case 32:case 64:if(m)return Integer.$valueOf(h);break;case 160:g=k}return Float.$valueOf(g)}return"NaN"},"~O,~N");l(c$,"getMinMaxPoint",function(c,a){var b=null,d=null,e=0;s(c,Array)?(b=c,e=b.length):s(c,JU.Lst)&&(d=c,e=d.size());if(null!=d||null!=b){for(var f=new JU.P3,g=u(e,0),h=!0,j=0;3>j&&h;j++){for(var k=0;k<e;k++){var l=null==b?JS.SV.ptValue(d.get(k)):b[k];if(null==l){h=!1;break}switch(j){case 0:g[k]=l.x;break;case 1:g[k]=l.y;
break;case 2:g[k]=l.z}}if(!h)break;k=this.getMinMax(g,a);if(s(k,Number))switch(k=k.floatValue(),j){case 0:f.x=k;break;case 1:f.y=k;break;case 2:f.z=k}else break}return f}return"NaN"},"~O,~N");l(c$,"getMinMaxQuaternion",function(c,a){var b;switch(a){case 32:case 64:case 128:case 160:return"NaN"}for(;;){b=this.e.getQuaternionArray(c,1073742001);if(null==b)break;var d=u(1,0);b=JU.Quat.sphereMean(b,d,1E-4);switch(a){case 96:return b;case 192:return Float.$valueOf(d[0])}break}return"NaN"},"JU.Lst,~N");
l(c$,"getPatternMatcher",function(){return null==this.pm?this.pm=J.api.Interface.getUtil("PatternMatcher",this.e.vwr,"script"):this.pm});l(c$,"opTokenFor",function(c){switch(c){case 1276118017:case 1276118022:return JS.T.tokenPlus;case 1276117511:return JS.T.tokenMinus;case 1276117507:return JS.T.tokenTimes;case 1276117508:return JS.T.tokenMul3;case 1276117504:return JS.T.tokenDivide}return null},"~N");l(c$,"setContactBitSets",function(c,a,b,d,e,f){var g,h;null==a?(a=JU.BSUtil.setAll(this.vwr.ms.ac),
JU.BSUtil.andNot(a,this.vwr.slm.bsDeleted),a.andNot(c),g=!1):(h=JU.BSUtil.copy(c),h.or(a),h=this.vwr.ms.getModelBS(h,!1).cardinality(),g=1<h,f&&(1<h&&!this.e.tQuiet)&&this.e.showString(J.i18n.GT._("Note: More than one model is involved in this contact!")));if(!c.equals(a)){if(f=!b||c.cardinality()<a.cardinality())h=this.vwr.ms.getAtomsWithinRadius(d,c,g,Float.isNaN(d)?e:null),a.and(h);b&&(h=this.vwr.ms.getAtomsWithinRadius(d,a,g,Float.isNaN(d)?e:null),c.and(h),f||(h=this.vwr.ms.getAtomsWithinRadius(d,
c,g,Float.isNaN(d)?e:null),a.and(h)),h=JU.BSUtil.copy(a),h.and(c),h.equals(c)?a.andNot(c):h.equals(a)&&c.andNot(a))}return a},"JU.BS,JU.BS,~B,~N,J.atomdata.RadiusData,~B")})})(Clazz,Clazz.newLongArray,Clazz.doubleToByte,Clazz.doubleToInt,Clazz.doubleToLong,Clazz.declarePackage,Clazz.instanceOf,Clazz.load,Clazz.instantialize,Clazz.decorateAsClass,Clazz.floatToInt,Clazz.floatToLong,Clazz.makeConstructor,Clazz.defineEnumConstant,Clazz.exceptionOf,Clazz.newIntArray,Clazz.defineStatics,Clazz.newFloatArray,
Clazz.declareType,Clazz.prepareFields,Clazz.superConstructor,Clazz.newByteArray,Clazz.declareInterface,Clazz.p0p,Clazz.pu$h,Clazz.newShortArray,Clazz.innerTypeInstance,Clazz.isClassDefined,Clazz.prepareCallback,Clazz.newArray,Clazz.castNullAs,Clazz.floatToShort,Clazz.superCall,Clazz.decorateAsType,Clazz.newBooleanArray,Clazz.newCharArray,Clazz.implementOf,Clazz.newDoubleArray,Clazz.overrideConstructor,Clazz.clone,Clazz.doubleToShort,Clazz.getInheritedLevel,Clazz.getParamsType,Clazz.isAF,Clazz.isAI,
Clazz.isAS,Clazz.isASS,Clazz.isAP,Clazz.isAFloat,Clazz.isAII,Clazz.isAFF,Clazz.isAFFF,Clazz.tryToSearchAndExecute,Clazz.getStackTrace,Clazz.inheritArgs,Clazz.alert,Clazz.defineMethod,Clazz.overrideMethod,Clazz.declareAnonymous,Clazz.cloneFinals);
