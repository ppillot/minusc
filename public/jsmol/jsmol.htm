<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <script src="jsmol/JSmol.min.js"></script>
    <style>
        html, body {
            padding: 0;
            margin: 0;
            height: 100%;
            width: 100%;
            overflow: hidden;
        }
    </style>
</head>
<script>
/// <reference path="../../src/jmol.d.ts" />
var myApplet;

        window.addEventListener('message', ev => {
            // console.log(JSON.parse(JSON.stringify(ev.data)));
            // if (ev.origin !== document.location.host) return;
            handle(ev.data);
        })

        function handle(data) {
            switch (data.type) {
                case 'initApplet':
                    if (data.payload.cb.ready) {
                        data.payload.readyFunction = readyFunction
                    }
                    Jmol.setDocument(0);
                    myApplet =  Jmol.getApplet('myApplet', data.payload);
                    $('body').append(Jmol.getAppletHtml(myApplet));
                    // Jmol.script('javascript alert')
                    //setJmol();
                    break;
                case 'script':
                    const spt = '' + data.payload;
                    Jmol.script(myApplet, spt);
                    break;

            }
        }

        function readyFunction () {
            returnMessage({type: 'ready'})
        }

        function returnMessage (opt) {
            opt.source = 'jmolIframe';
            window.parent.postMessage(opt, '*');
        }


        </script>
<body >
<script>


    </script>
</body>
</html>